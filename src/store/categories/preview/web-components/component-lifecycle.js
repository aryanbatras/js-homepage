export const componentLifecycle = {
  title: "Component Lifecycle",
  description: "Master web component lifecycle callbacks and state management",
  code_examples: [
    {
      example: "Example 1:",
      code: "class LifecycleComponent extends HTMLElement {\n  constructor() {\n    super();\n    console.log('Constructor called');\n  }\n  \n  connectedCallback() {\n    console.log('Component connected to DOM');\n  }\n  \n  disconnectedCallback() {\n    console.log('Component disconnected from DOM');\n  }\n}",
    },
  ],
  hints: [
    {
      hint: "Hint: Use connectedCallback for initialization",
    },
    {
      hint: "Consider disconnectedCallback for cleanup",
    },
  ],
  solution: [
    {
      approach: "Approach 1: Complete lifecycle management",
      code: "class FullLifecycleComponent extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n    this.state = {};\n  }\n  \n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n  }\n  \n  disconnectedCallback() {\n    this.cleanup();\n  }\n  \n  attributeChangedCallback(name, oldValue, newValue) {\n    this.handleAttributeChange(name, oldValue, newValue);\n  }\n}",
    },
  ],
  files: [
    {
      name: "index.html",
      code: "<!DOCTYPE html>\n<html lang='en'>\n<head>\n  <meta charset='UTF-8'>\n  <meta name='viewport' content='width=device-width, initial-scale=1.0'>\n  <title>Component Lifecycle</title>\n  <link rel='stylesheet' href='styles.css'>\n</head>\n<body>\n  <div class='container'>\n    <h1>Component Lifecycle</h1>\n    \n    <div class='demo-section'>\n      <h3>Lifecycle Events</h3>\n      <div class='lifecycle-demo'>\n        <lifecycle-component id='demo-component'>\n          <span slot='content'>Demo Component</span>\n        </lifecycle-component>\n        \n        <div class='controls'>\n          <button id='toggle-component'>Toggle Component</button>\n          <button id='update-attribute'>Update Attribute</button>\n          <button id='clear-log'>Clear Log</button>\n        </div>\n        \n        <div class='log-container'>\n          <h4>Event Log:</h4>\n          <div id='event-log'></div>\n        </div>\n      </div>\n    </div>\n    \n    <div class='demo-section'>\n      <h3>State Management</h3>\n      <div class='state-demo'>\n        <stateful-component id='state-component'></stateful-component>\n        \n        <div class='state-controls'>\n          <button id='increment-state'>Increment</button>\n          <button id='decrement-state'>Decrement</button>\n          <button id='reset-state'>Reset</button>\n        </div>\n      </div>\n    </div>\n    \n    <div class='demo-section'>\n      <h3>Dynamic Components</h3>\n      <div class='dynamic-demo'>\n        <div id='dynamic-container'></div>\n        \n        <div class='dynamic-controls'>\n          <button id='add-component'>Add Component</button>\n          <button id='remove-component'>Remove Component</button>\n          <button id='update-components'>Update All</button>\n        </div>\n      </div>\n    </div>\n  </div>\n  \n  <script src='script.js'></script>\n</body>\n</html>"
    },
    {
      name: "styles.css",
      code: "* { margin: 0; padding: 0; box-sizing: border-box; }\nbody { font-family: Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 2rem; }\n.container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 16px; padding: 2rem; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }\nh1 { color: #333; margin-bottom: 2rem; text-align: center; font-size: 2.5rem; }\n.demo-section { margin: 3rem 0; padding: 2rem; border: 2px solid #f0f0f0; border-radius: 12px; background: #fafafa; }\n.demo-section h3 { color: #666; margin-bottom: 1.5rem; font-size: 1.2rem; text-align: center; }\n.lifecycle-demo, .state-demo, .dynamic-demo { padding: 2rem; background: white; border-radius: 12px; border: 2px solid #dee2e6; }\n.controls, .state-controls, .dynamic-controls { display: flex; gap: 1rem; margin: 1rem 0; flex-wrap: wrap; }\n.controls button, .state-controls button, .dynamic-controls button { background: #667eea; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 6px; cursor: pointer; }\n.controls button:hover, .state-controls button:hover, .dynamic-controls button:hover { background: #5a67d8; }\n.log-container { margin-top: 1rem; }\n.log-container h4 { color: #333; margin-bottom: 0.5rem; }\n#event-log { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; padding: 1rem; height: 200px; overflow-y: auto; font-family: monospace; font-size: 0.875rem; }\n.log-entry { padding: 0.25rem 0; border-bottom: 1px solid #e9ecef; }\n.log-entry:last-child { border-bottom: none; }\n\n/* Responsive Design */\n@media (max-width: 768px) {\n  .container { padding: 1rem; }\n  .demo-section { padding: 1rem; }\n  .lifecycle-demo, .state-demo, .dynamic-demo { padding: 1rem; }\n  .controls, .state-controls, .dynamic-controls { flex-direction: column; }\n}"
    },
    {
      name: "script.js",
      code: "// Component Lifecycle Implementation\n\nclass LifecycleComponent extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n    this.logEvent('Constructor called');\n  }\n  \n  static get observedAttributes() {\n    return ['data-value', 'status'];\n  }\n  \n  connectedCallback() {\n    this.logEvent('Connected to DOM');\n    this.render();\n    this.setupEventListeners();\n  }\n  \n  disconnectedCallback() {\n    this.logEvent('Disconnected from DOM');\n    this.cleanup();\n  }\n  \n  attributeChangedCallback(name, oldValue, newValue) {\n    this.logEvent(`Attribute changed: ${name} from ${oldValue} to ${newValue}`);\n    this.render();\n  }\n  \n  adoptedCallback() {\n    this.logEvent('Adopted to new document');\n  }\n  \n  render() {\n    const value = this.getAttribute('data-value') || 'default';\n    const status = this.getAttribute('status') || 'active';\n    \n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: block;\n          padding: 1rem;\n          background: linear-gradient(45deg, #667eea, #764ba2);\n          color: white;\n          border-radius: 8px;\n          margin: 1rem 0;\n        }\n        \n        .content {\n          text-align: center;\n        }\n        \n        .status {\n          font-size: 0.875rem;\n          opacity: 0.8;\n          margin-top: 0.5rem;\n        }\n      </style>\n      <div class='content'>\n        <slot></slot>\n        <div class='status'>Value: ${value} | Status: ${status}</div>\n      </div>\n    `;\n  }\n  \n  setupEventListeners() {\n    this.addEventListener('click', () => {\n      this.logEvent('Component clicked');\n    });\n  }\n  \n  cleanup() {\n    this.logEvent('Cleanup completed');\n  }\n  \n  logEvent(message) {\n    const timestamp = new Date().toLocaleTimeString();\n    const logEntry = document.createElement('div');\n    logEntry.className = 'log-entry';\n    logEntry.textContent = `[${timestamp}] ${message}`;\n    \n    const eventLog = document.getElementById('event-log');\n    if (eventLog) {\n      eventLog.appendChild(logEntry);\n      eventLog.scrollTop = eventLog.scrollHeight;\n    }\n  }\n}\n\nclass StatefulComponent extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n    this.state = { count: 0, name: 'Stateful Component' };\n  }\n  \n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n  }\n  \n  render() {\n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: block;\n          padding: 1.5rem;\n          background: white;\n          border-radius: 8px;\n          box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n          border: 1px solid #e0e0e0;\n          text-align: center;\n        }\n        \n        .count {\n          font-size: 2rem;\n          font-weight: bold;\n          color: #667eea;\n          margin: 1rem 0;\n        }\n        \n        .name {\n          color: #333;\n          margin-bottom: 1rem;\n        }\n        \n        .controls {\n          display: flex;\n          gap: 0.5rem;\n          justify-content: center;\n        }\n        \n        button {\n          background: #667eea;\n          color: white;\n          border: none;\n          padding: 0.5rem 1rem;\n          border-radius: 4px;\n          cursor: pointer;\n        }\n        \n        button:hover {\n          background: #5a67d8;\n        }\n      </style>\n      <div class='name'>${this.state.name}</div>\n      <div class='count'>Count: ${this.state.count}</div>\n      <div class='controls'>\n        <button class='increment'>+</button>\n        <button class='decrement'>-</button>\n        <button class='reset'>Reset</button>\n      </div>\n    `;\n    \n    this.setupInternalListeners();\n  }\n  \n  setupEventListeners() {\n    // External controls\n    document.getElementById('increment-state')?.addEventListener('click', () => {\n      this.increment();\n    });\n    \n    document.getElementById('decrement-state')?.addEventListener('click', () => {\n      this.decrement();\n    });\n    \n    document.getElementById('reset-state')?.addEventListener('click', () => {\n      this.reset();\n    });\n  }\n  \n  setupInternalListeners() {\n    const incrementBtn = this.shadowRoot.querySelector('.increment');\n    const decrementBtn = this.shadowRoot.querySelector('.decrement');\n    const resetBtn = this.shadowRoot.querySelector('.reset');\n    \n    incrementBtn?.addEventListener('click', () => this.increment());\n    decrementBtn?.addEventListener('click', () => this.decrement());\n    resetBtn?.addEventListener('click', () => this.reset());\n  }\n  \n  increment() {\n    this.state.count++;\n    this.render();\n    this.dispatchStateChange();\n  }\n  \n  decrement() {\n    this.state.count--;\n    this.render();\n    this.dispatchStateChange();\n  }\n  \n  reset() {\n    this.state.count = 0;\n    this.render();\n    this.dispatchStateChange();\n  }\n  \n  dispatchStateChange() {\n    this.dispatchEvent(new CustomEvent('state-change', {\n      bubbles: true,\n      detail: { count: this.state.count }\n    }));\n  }\n}\n\nclass DynamicComponent extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n    this.id = Math.random().toString(36).substr(2, 9);\n  }\n  \n  connectedCallback() {\n    this.render();\n  }\n  \n  static get observedAttributes() {\n    return ['data-update'];\n  }\n  \n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === 'data-update') {\n      this.render();\n    }\n  }\n  \n  render() {\n    const updateCount = this.getAttribute('data-update') || '0';\n    \n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: inline-block;\n          padding: 0.75rem;\n          margin: 0.5rem;\n          background: #4ecdc4;\n          color: white;\n          border-radius: 6px;\n          font-size: 0.875rem;\n        }\n      </style>\n      Component ${this.id} (Updated: ${updateCount})\n    `;\n  }\n}\n\n// Register custom elements\ncustomElements.define('lifecycle-component', LifecycleComponent);\ncustomElements.define('stateful-component', StatefulComponent);\ncustomElements.define('dynamic-component', DynamicComponent);\n\n// Demo functionality\nclass LifecycleDemo {\n  constructor() {\n    this.componentVisible = true;\n    this.dynamicComponents = [];\n    this.init();\n  }\n  \n  init() {\n    this.setupLifecycleDemo();\n    this.setupDynamicDemo();\n  }\n  \n  setupLifecycleDemo() {\n    const toggleBtn = document.getElementById('toggle-component');\n    const updateBtn = document.getElementById('update-attribute');\n    const clearBtn = document.getElementById('clear-log');\n    \n    toggleBtn.addEventListener('click', () => {\n      const component = document.getElementById('demo-component');\n      if (this.componentVisible) {\n        component.remove();\n      } else {\n        document.querySelector('.lifecycle-demo').insertBefore(\n          component,\n          document.querySelector('.controls')\n        );\n      }\n      this.componentVisible = !this.componentVisible;\n    });\n    \n    updateBtn.addEventListener('click', () => {\n      const component = document.getElementById('demo-component');\n      if (component) {\n        const currentValue = component.getAttribute('data-value') || '0';\n        component.setAttribute('data-value', String(parseInt(currentValue) + 1));\n        \n        const currentStatus = component.getAttribute('status') || 'active';\n        const newStatus = currentStatus === 'active' ? 'inactive' : 'active';\n        component.setAttribute('status', newStatus);\n      }\n    });\n    \n    clearBtn.addEventListener('click', () => {\n      const eventLog = document.getElementById('event-log');\n      eventLog.innerHTML = '';\n    });\n  }\n  \n  setupDynamicDemo() {\n    const addBtn = document.getElementById('add-component');\n    const removeBtn = document.getElementById('remove-component');\n    const updateBtn = document.getElementById('update-components');\n    \n    addBtn.addEventListener('click', () => {\n      const component = document.createElement('dynamic-component');\n      document.getElementById('dynamic-container').appendChild(component);\n      this.dynamicComponents.push(component);\n    });\n    \n    removeBtn.addEventListener('click', () => {\n      if (this.dynamicComponents.length > 0) {\n        const component = this.dynamicComponents.pop();\n        component.remove();\n      }\n    });\n    \n    updateBtn.addEventListener('click', () => {\n      this.dynamicComponents.forEach((component, index) => {\n        const currentCount = component.getAttribute('data-update') || '0';\n        component.setAttribute('data-update', String(parseInt(currentCount) + 1));\n      });\n    });\n  }\n}\n\n// Initialize demo\ndocument.addEventListener('DOMContentLoaded', () => {\n  new LifecycleDemo();\n  \n  // Listen for state changes\n  document.addEventListener('state-change', (e) => {\n    console.log('State changed:', e.detail);\n  });\n  \n  console.log('Component Lifecycle demo initialized');\n});"
    }
  ],
  tests: [
    {
      test: "Test 1: Component lifecycle",
      code: "const component = document.createElement('lifecycle-component');\nconsole.log('Component created:', component.constructor.name);"
    }
  ],
};
