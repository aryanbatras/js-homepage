export const stateManagement = {
  title: "State Management System",
  description: "Build a comprehensive state management system with actions, reducers, and reactive updates",
  code_examples: [
    {
      example: "Example 1:",
      code: "class Store {\n  constructor(reducer, initialState) {\n    this.state = initialState;\n    this.reducer = reducer;\n    this.listeners = [];\n  }\n  \n  dispatch(action) {\n    this.state = this.reducer(this.state, action);\n    this.notify();\n  }\n}",
    },
  ],
  hints: [
    {
      hint: "Hint: Use observer pattern for reactive updates",
    },
    {
      hint: "Consider immutable state updates",
    },
  ],
  solution: [
    {
      approach: "Approach 1: Redux-like Store",
      code: "function createStore(reducer, initialState) {\n  let state = initialState;\n  let listeners = [];\n  \n  return {\n    getState: () => state,\n    dispatch: (action) => {\n      state = reducer(state, action);\n      listeners.forEach(listener => listener());\n    },\n    subscribe: (listener) => {\n      listeners.push(listener);\n      return () => listeners = listeners.filter(l => l !== listener);\n    }\n  };\n}",
    },
  ],
  files: [
    {
      name: "index.html",
      code: "<!DOCTYPE html>\n<html lang='en'>\n<head>\n  <meta charset='UTF-8'>\n  <meta name='viewport' content='width=device-width, initial-scale=1.0'>\n  <title>State Management System</title>\n  <link rel='stylesheet' href='styles.css'>\n</head>\n<body>\n  <div class='container'>\n    <h1>State Management System</h1>\n    \n    <div class='state-section'>\n      <h3>Counter Application</h3>\n      <div class='counter-app'>\n        <div class='counter-display'>\n          <span class='counter-value' id='counterValue'>0</span>\n        </div>\n        <div class='counter-controls'>\n          <button id='increment'>Increment</button>\n          <button id='decrement'>Decrement</button>\n          <button id='reset'>Reset</button>\n          <button id='incrementBy5'>+5</button>\n        </div>\n        <div class='counter-info'>\n          <p>Last Action: <span id='lastAction'>None</span></p>\n          <p>Action Count: <span id='actionCount'>0</span></p>\n        </div>\n      </div>\n    </div>\n    \n    <div class='state-section'>\n      <h3>Todo List</h3>\n      <div class='todo-app'>\n        <div class='todo-input'>\n          <input type='text' id='todoInput' placeholder='Add new todo...'>\n          <button id='addTodo'>Add</button>\n        </div>\n        <div class='todo-filters'>\n          <button class='filter-btn active' data-filter='all'>All</button>\n          <button class='filter-btn' data-filter='active'>Active</button>\n          <button class='filter-btn' data-filter='completed'>Completed</button>\n        </div>\n        <div class='todo-list' id='todoList'>\n          <!-- Todos will be rendered here -->\n        </div>\n        <div class='todo-stats'>\n          <span>Total: <span id='totalTodos'>0</span></span>\n          <span>Active: <span id='activeTodos'>0</span></span>\n          <span>Completed: <span id='completedTodos'>0</span></span>\n        </div>\n      </div>\n    </div>\n    \n    <div class='state-section'>\n      <h3>Shopping Cart</h3>\n      <div class='cart-app'>\n        <div class='products'>\n          <div class='product' data-id='1'>\n            <h4>Laptop</h4>\n            <p class='price'>$999</p>\n            <button class='add-to-cart'>Add to Cart</button>\n          </div>\n          <div class='product' data-id='2'>\n            <h4>Phone</h4>\n            <p class='price'>$699</p>\n            <button class='add-to-cart'>Add to Cart</button>\n          </div>\n          <div class='product' data-id='3'>\n            <h4>Headphones</h4>\n            <p class='price'>$199</p>\n            <button class='add-to-cart'>Add to Cart</button>\n          </div>\n        </div>\n        <div class='cart'>\n          <h4>Shopping Cart</h4>\n          <div class='cart-items' id='cartItems'>\n            <!-- Cart items will be rendered here -->\n          </div>\n          <div class='cart-total'>\n            <span>Total: $<span id='cartTotal'>0</span></span>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <div class='state-section'>\n      <h3>State History</h3>\n      <div class='history-panel'>\n        <div class='history-controls'>\n          <button id='undo'>Undo</button>\n          <button id='redo'>Redo</button>\n          <button id='clearHistory'>Clear History</button>\n        </div>\n        <div class='history-list' id='historyList'>\n          <!-- History items will be displayed here -->\n        </div>\n      </div>\n    </div>\n    \n    <div class='state-section'>\n      <h3>State Inspector</h3>\n      <div class='inspector-panel'>\n        <div class='inspector-controls'>\n          <button id='refreshInspector'>Refresh</button>\n          <button id='exportState'>Export State</button>\n        </div>\n        <pre id='stateDisplay' class='state-display'>\n          {/* Current state will be displayed here */}\n        </pre>\n      </div>\n    </div>\n  </div>\n  <script src='script.js'></script>\n</body>\n</html>"
    },
    {
      name: "styles.css",
      code: "* { margin: 0; padding: 0; box-sizing: border-box; }\nbody { font-family: Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 2rem; }\n.container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 16px; padding: 2rem; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }\nh1 { color: #333; margin-bottom: 2rem; text-align: center; font-size: 2.5rem; }\n.state-section { margin: 3rem 0; padding: 2rem; border: 2px solid #f0f0f0; border-radius: 12px; background: #fafafa; }\n.state-section h3 { color: #666; margin-bottom: 1.5rem; font-size: 1.2rem; text-align: center; }\n\n/* Counter App */\n.counter-app { background: white; border-radius: 12px; padding: 2rem; text-align: center; border: 2px solid #dee2e6; }\n.counter-display { margin-bottom: 2rem; }\n.counter-value { font-size: 4rem; font-weight: bold; color: #667eea; }\n.counter-controls { display: flex; justify-content: center; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap; }\n.counter-controls button { padding: 0.8rem 1.5rem; background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: transform 0.2s ease; }\n.counter-controls button:hover { transform: translateY(-2px); }\n.counter-info { display: flex; justify-content: center; gap: 2rem; color: #666; }\n\n/* Todo App */\n.todo-app { background: white; border-radius: 12px; padding: 2rem; border: 2px solid #dee2e6; }\n.todo-input { display: flex; gap: 1rem; margin-bottom: 1.5rem; }\n.todo-input input { flex: 1; padding: 0.8rem; border: 2px solid #dee2e6; border-radius: 6px; font-size: 1rem; }\n.todo-input button { padding: 0.8rem 1.5rem; background: #27ae60; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }\n.todo-filters { display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 1.5rem; }\n.filter-btn { padding: 0.5rem 1rem; background: #ecf0f1; color: #7f8c8d; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease; }\n.filter-btn.active { background: #3498db; color: white; }\n.todo-list { margin-bottom: 1.5rem; max-height: 300px; overflow-y: auto; }\n.todo-item { display: flex; align-items: center; gap: 1rem; padding: 1rem; margin-bottom: 0.5rem; background: #f8f9fa; border-radius: 6px; border-left: 3px solid #3498db; }\n.todo-item.completed { opacity: 0.6; border-left-color: #27ae60; }\n.todo-item.completed .todo-text { text-decoration: line-through; }\n.todo-checkbox { width: 20px; height: 20px; cursor: pointer; }\n.todo-text { flex: 1; color: #333; }\n.todo-delete { background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 0.3rem 0.6rem; cursor: pointer; }\n.todo-stats { display: flex; justify-content: center; gap: 2rem; color: #666; }\n\n/* Shopping Cart */\n.cart-app { background: white; border-radius: 12px; padding: 2rem; border: 2px solid #dee2e6; }\n.products { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }\n.product { text-align: center; padding: 1.5rem; background: #f8f9fa; border-radius: 8px; border: 2px solid transparent; transition: all 0.3s ease; }\n.product:hover { border-color: #667eea; transform: translateY(-2px); }\n.product h4 { color: #333; margin-bottom: 0.5rem; }\n.product .price { color: #667eea; font-weight: bold; margin-bottom: 1rem; }\n.add-to-cart { padding: 0.6rem 1.2rem; background: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer; }\n.cart { background: #f8f9fa; border-radius: 8px; padding: 1.5rem; }\n.cart h4 { color: #333; margin-bottom: 1rem; }\n.cart-items { margin-bottom: 1rem; max-height: 200px; overflow-y: auto; }\n.cart-item { display: flex; justify-content: space-between; align-items: center; padding: 0.8rem; margin-bottom: 0.5rem; background: white; border-radius: 4px; }\n.cart-item button { background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 0.2rem 0.5rem; cursor: pointer; }\n.cart-total { text-align: right; font-size: 1.2rem; font-weight: bold; color: #333; }\n\n/* History Panel */\n.history-panel { background: white; border-radius: 12px; padding: 2rem; border: 2px solid #dee2e6; }\n.history-controls { display: flex; justify-content: center; gap: 1rem; margin-bottom: 1.5rem; }\n.history-controls button { padding: 0.6rem 1.2rem; background: #f39c12; color: white; border: none; border-radius: 4px; cursor: pointer; }\n.history-list { max-height: 300px; overflow-y: auto; background: #f8f9fa; border-radius: 8px; padding: 1rem; }\n.history-item { display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; margin-bottom: 0.5rem; background: white; border-radius: 4px; border-left: 3px solid #f39c12; }\n.history-action { font-weight: bold; color: #333; }\n.history-time { color: #7f8c8d; font-size: 0.9rem; }\n\n/* Inspector Panel */\n.inspector-panel { background: white; border-radius: 12px; padding: 2rem; border: 2px solid #dee2e6; }\n.inspector-controls { display: flex; justify-content: center; gap: 1rem; margin-bottom: 1.5rem; }\n.inspector-controls button { padding: 0.6rem 1.2rem; background: #9b59b6; color: white; border: none; border-radius: 4px; cursor: pointer; }\n.state-display { background: #2d3748; color: #e2e8f0; padding: 1.5rem; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9rem; overflow-x: auto; white-space: pre-wrap; max-height: 400px; overflow-y: auto; }\n\n@media (max-width: 768px) { .container { padding: 1rem; } .state-section { padding: 1rem; } .counter-controls { flex-direction: column; } .todo-filters { flex-wrap: wrap; } .products { grid-template-columns: 1fr; } .history-controls, .inspector-controls { flex-direction: column; } }"
    },
    {
      name: "script.js",
      code: "// State Management System\n\nclass StateManager {\n  constructor() {\n    this.state = {\n      counter: { value: 0, lastAction: 'None', actionCount: 0 },\n      todos: { items: [], filter: 'all' },\n      cart: { items: [], total: 0 },\n      history: { past: [], present: null, future: [] }\n    };\n    \n    this.listeners = new Map();\n    this.init();\n  }\n  \n  init() {\n    this.saveState();\n    this.setupEventListeners();\n    this.render();\n  }\n  \n  // State management methods\n  getState(path = null) {\n    if (path) {\n      return path.split('.').reduce((obj, key) => obj && obj[key], this.state);\n    }\n    return this.state;\n  }\n  \n  setState(updates, action = null) {\n    const previousState = JSON.parse(JSON.stringify(this.state));\n    \n    // Apply updates\n    if (typeof updates === 'function') {\n      updates(this.state);\n    } else {\n      Object.assign(this.state, updates);\n    }\n    \n    // Save to history\n    if (action) {\n      this.saveToHistory(action, previousState);\n    }\n    \n    // Notify listeners\n    this.notify();\n    \n    // Render\n    this.render();\n  }\n  \n  subscribe(key, callback) {\n    if (!this.listeners.has(key)) {\n      this.listeners.set(key, []);\n    }\n    this.listeners.get(key).push(callback);\n    \n    // Return unsubscribe function\n    return () => {\n      const callbacks = this.listeners.get(key);\n      if (callbacks) {\n        const index = callbacks.indexOf(callback);\n        if (index > -1) {\n          callbacks.splice(index, 1);\n        }\n      }\n    };\n  }\n  \n  notify() {\n    this.listeners.forEach((callbacks, key) => {\n      const stateValue = this.getState(key);\n      callbacks.forEach(callback => callback(stateValue, this.state));\n    });\n  }\n  \n  // History management\n  saveState() {\n    this.state.history.present = JSON.parse(JSON.stringify(this.state));\n  }\n  \n  saveToHistory(action, previousState) {\n    this.state.history.past.push({\n      state: previousState,\n      action: action,\n      timestamp: new Date().toLocaleTimeString()\n    });\n    this.state.history.future = []; // Clear future on new action\n    \n    // Keep only last 20 actions\n    if (this.state.history.past.length > 20) {\n      this.state.history.past.shift();\n    }\n  }\n  \n  undo() {\n    if (this.state.history.past.length === 0) return;\n    \n    const previous = this.state.history.past.pop();\n    this.state.history.future.push({\n      state: JSON.parse(JSON.stringify(this.state)),\n      action: 'Undo',\n      timestamp: new Date().toLocaleTimeString()\n    });\n    \n    Object.assign(this.state, previous.state);\n    this.notify();\n    this.render();\n  }\n  \n  redo() {\n    if (this.state.history.future.length === 0) return;\n    \n    const next = this.state.history.future.pop();\n    this.state.history.past.push({\n      state: JSON.parse(JSON.stringify(this.state)),\n      action: 'Redo',\n      timestamp: new Date().toLocaleTimeString()\n    });\n    \n    Object.assign(this.state, next.state);\n    this.notify();\n    this.render();\n  }\n  \n  // Counter actions\n  increment() {\n    this.setState(state => {\n      state.counter.value++;\n      state.counter.lastAction = 'Increment';\n      state.counter.actionCount++;\n    }, 'INCREMENT');\n  }\n  \n  decrement() {\n    this.setState(state => {\n      state.counter.value--;\n      state.counter.lastAction = 'Decrement';\n      state.counter.actionCount++;\n    }, 'DECREMENT');\n  }\n  \n  reset() {\n    this.setState(state => {\n      state.counter.value = 0;\n      state.counter.lastAction = 'Reset';\n      state.counter.actionCount++;\n    }, 'RESET');\n  }\n  \n  incrementBy(amount) {\n    this.setState(state => {\n      state.counter.value += amount;\n      state.counter.lastAction = `Increment by ${amount}`;\n      state.counter.actionCount++;\n    }, `INCREMENT_BY_${amount}`);\n  }\n  \n  // Todo actions\n  addTodo(text) {\n    if (!text.trim()) return;\n    \n    this.setState(state => {\n      state.todos.items.push({\n        id: Date.now(),\n        text: text.trim(),\n        completed: false,\n        createdAt: new Date().toISOString()\n      });\n    }, 'ADD_TODO');\n  }\n  \n  toggleTodo(id) {\n    this.setState(state => {\n      const todo = state.todos.items.find(item => item.id === id);\n      if (todo) {\n        todo.completed = !todo.completed;\n      }\n    }, 'TOGGLE_TODO');\n  }\n  \n  deleteTodo(id) {\n    this.setState(state => {\n      state.todos.items = state.todos.items.filter(item => item.id !== id);\n    }, 'DELETE_TODO');\n  }\n  \n  setTodoFilter(filter) {\n    this.setState(state => {\n      state.todos.filter = filter;\n    }, 'SET_FILTER');\n  }\n  \n  // Cart actions\n  addToCart(product) {\n    this.setState(state => {\n      const existingItem = state.cart.items.find(item => item.id === product.id);\n      \n      if (existingItem) {\n        existingItem.quantity++;\n      } else {\n        state.cart.items.push({\n          ...product,\n          quantity: 1\n        });\n      }\n      \n      // Update total\n      state.cart.total = state.cart.items.reduce((sum, item) => {\n        return sum + (item.price * item.quantity);\n      }, 0);\n    }, 'ADD_TO_CART');\n  }\n  \n  removeFromCart(id) {\n    this.setState(state => {\n      state.cart.items = state.cart.items.filter(item => item.id !== id);\n      \n      // Update total\n      state.cart.total = state.cart.items.reduce((sum, item) => {\n        return sum + (item.price * item.quantity);\n      }, 0);\n    }, 'REMOVE_FROM_CART');\n  }\n  \n  updateQuantity(id, quantity) {\n    this.setState(state => {\n      const item = state.cart.items.find(item => item.id === id);\n      if (item) {\n        item.quantity = Math.max(1, quantity);\n      }\n      \n      // Update total\n      state.cart.total = state.cart.items.reduce((sum, item) => {\n        return sum + (item.price * item.quantity);\n      }, 0);\n    }, 'UPDATE_QUANTITY');\n  }\n  \n  // Rendering methods\n  render() {\n    this.renderCounter();\n    this.renderTodos();\n    this.renderCart();\n    this.renderHistory();\n    this.renderStateInspector();\n  }\n  \n  renderCounter() {\n    const counter = this.state.counter;\n    document.getElementById('counterValue').textContent = counter.value;\n    document.getElementById('lastAction').textContent = counter.lastAction;\n    document.getElementById('actionCount').textContent = counter.actionCount;\n  }\n  \n  renderTodos() {\n    const { items, filter } = this.state.todos;\n    const todoList = document.getElementById('todoList');\n    \n    let filteredItems = items;\n    if (filter === 'active') {\n      filteredItems = items.filter(item => !item.completed);\n    } else if (filter === 'completed') {\n      filteredItems = items.filter(item => item.completed);\n    }\n    \n    todoList.innerHTML = filteredItems.map(todo => `\n      <div class='todo-item ${todo.completed ? 'completed' : ''}'>\n        <input type='checkbox' class='todo-checkbox' ${todo.completed ? 'checked' : ''} data-id='${todo.id}'>\n        <span class='todo-text'>${todo.text}</span>\n        <button class='todo-delete' data-id='${todo.id}'>×</button>\n      </div>\n    `).join('');\n    \n    // Update stats\n    const total = items.length;\n    const completed = items.filter(item => item.completed).length;\n    const active = total - completed;\n    \n    document.getElementById('totalTodos').textContent = total;\n    document.getElementById('activeTodos').textContent = active;\n    document.getElementById('completedTodos').textContent = completed;\n    \n    // Add event listeners\n    todoList.querySelectorAll('.todo-checkbox').forEach(checkbox => {\n      checkbox.addEventListener('change', (e) => {\n        this.toggleTodo(parseInt(e.target.dataset.id));\n      });\n    });\n    \n    todoList.querySelectorAll('.todo-delete').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        this.deleteTodo(parseInt(e.target.dataset.id));\n      });\n    });\n  }\n  \n  renderCart() {\n    const { items, total } = this.state.cart;\n    const cartItems = document.getElementById('cartItems');\n    \n    if (items.length === 0) {\n      cartItems.innerHTML = '<p style=\"text-align: center; color: #666;\">Cart is empty</p>';\n    } else {\n      cartItems.innerHTML = items.map(item => `\n        <div class='cart-item'>\n          <span>${item.name || item.h4} x${item.quantity}</span>\n          <span>$${(item.price * item.quantity).toFixed(2)}</span>\n          <button onclick='stateManager.removeFromCart(${item.id})'>×</button>\n        </div>\n      `).join('');\n    }\n    \n    document.getElementById('cartTotal').textContent = total.toFixed(2);\n  }\n  \n  renderHistory() {\n    const historyList = document.getElementById('historyList');\n    const { past, future } = this.state.history;\n    \n    const allHistory = [...past, ...future].reverse();\n    \n    if (allHistory.length === 0) {\n      historyList.innerHTML = '<p style=\"text-align: center; color: #666;\">No history</p>';\n    } else {\n      historyList.innerHTML = allHistory.map(item => `\n        <div class='history-item'>\n          <span class='history-action'>${item.action}</span>\n          <span class='history-time'>${item.timestamp}</span>\n        </div>\n      `).join('');\n    }\n  }\n  \n  renderStateInspector() {\n    const stateDisplay = document.getElementById('stateDisplay');\n    stateDisplay.textContent = JSON.stringify(this.state, null, 2);\n  }\n  \n  // Event listeners\n  setupEventListeners() {\n    // Counter controls\n    document.getElementById('increment').addEventListener('click', () => this.increment());\n    document.getElementById('decrement').addEventListener('click', () => this.decrement());\n    document.getElementById('reset').addEventListener('click', () => this.reset());\n    document.getElementById('incrementBy5').addEventListener('click', () => this.incrementBy(5));\n    \n    // Todo controls\n    document.getElementById('addTodo').addEventListener('click', () => {\n      const input = document.getElementById('todoInput');\n      this.addTodo(input.value);\n      input.value = '';\n    });\n    \n    document.getElementById('todoInput').addEventListener('keypress', (e) => {\n      if (e.key === 'Enter') {\n        this.addTodo(e.target.value);\n        e.target.value = '';\n      }\n    });\n    \n    // Todo filters\n    document.querySelectorAll('.filter-btn').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));\n        e.target.classList.add('active');\n        this.setTodoFilter(e.target.dataset.filter);\n      });\n    });\n    \n    // Product controls\n    document.querySelectorAll('.add-to-cart').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const productEl = e.target.closest('.product');\n        const product = {\n          id: parseInt(productEl.dataset.id),\n          name: productEl.querySelector('h4').textContent,\n          price: parseInt(productEl.querySelector('.price').textContent.replace('$', ''))\n        };\n        this.addToCart(product);\n      });\n    });\n    \n    // History controls\n    document.getElementById('undo').addEventListener('click', () => this.undo());\n    document.getElementById('redo').addEventListener('click', () => this.redo());\n    document.getElementById('clearHistory').addEventListener('click', () => {\n      this.setState(state => {\n        state.history.past = [];\n        state.history.future = [];\n      }, 'CLEAR_HISTORY');\n    });\n    \n    // Inspector controls\n    document.getElementById('refreshInspector').addEventListener('click', () => {\n      this.renderStateInspector();\n    });\n    \n    document.getElementById('exportState').addEventListener('click', () => {\n      const dataStr = JSON.stringify(this.state, null, 2);\n      const dataBlob = new Blob([dataStr], { type: 'application/json' });\n      const url = URL.createObjectURL(dataBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = 'state.json';\n      link.click();\n      URL.revokeObjectURL(url);\n    });\n  }\n}\n\n// Initialize the state manager\nconst stateManager = new StateManager();"
    }
  ],
  tests: [
    {
      test: "Test 1: State manager initialization",
      code: "const manager = new StateManager();\nconsole.log('Initial state:', manager.getState());"
    }
  ],
};
